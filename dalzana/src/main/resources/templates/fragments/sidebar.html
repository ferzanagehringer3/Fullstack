<!DOCTYPE html>
<html lang="de" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
</head>
<body>
    <div th:fragment="sidebar" class="left" style="position: sticky; top: 64px; height: calc(100vh - 64px);">
      <div class="sidebar-head">
        <h3>Menue</h3>
        <button id="toggleSidebarBtn" class="toggle-sidebar-btn" title="Sidebar ein/aus"
          aria-label="Sidebar ein/aus">☰</button>
      </div>

      <div class="sidebar-content">

        <div class="accordion" id="sidebarAccordion">

          <!-- TEAMS -->
          <div class="acc-item open" data-acc="teams">
            <button type="button" class="acc-trigger" aria-expanded="true" aria-controls="acc-teams">
              <span>Teams</span>
              <span class="acc-icon">▾</span>
            </button>

            <div class="acc-panel" id="acc-teams">
              <!-- Create Team Button (nur hier drin) -->
              <div th:if="${currentUserRole == 'MANAGER'}" style="margin: 12px 0 16px 0;">
                <a href="/teams/create" th:href="@{/teams/create}" style="text-decoration: none;">
                  <button class="create-btn">+ Neues Team erstellen</button>
                </a>
              </div>

              <!-- Team List -->
              <div class="teams" id="teamList">
                <div th:if="${#lists.isEmpty(teams)}">Keine Teams vorhanden</div>

                <div th:each="t : ${teams}" class="team-row">
                  <button class="team" th:data-team-id="${t.id}" th:data-team-name="${t.name}"
                    th:data-request-title="${t.request?.title}"
                    th:data-team-members="${#strings.listJoin(t.members.![name], ', ')}">
                    <span th:text="${t.name}">Team</span>
                    <span th:if="${t.request}" style="color:#6b7280;font-size:12px;display:block;margin-top:4px;"
                      th:text="'Request: ' + ${t.request.title}">Request</span>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- REQUESTS -->
          <div class="acc-item" data-acc="requests">
            <button type="button" class="acc-trigger" aria-expanded="false" aria-controls="acc-requests">
              <span>Requests</span>
              <span class="acc-icon">▾</span>
            </button>

            <div class="acc-panel" id="acc-requests">
              <div class="requests" id="requestList">
                <div th:if="${requests == null or #lists.isEmpty(requests)}">Keine Requests vorhanden</div>

                <div th:each="r : ${requests}" class="request-row">
                  <a class="request-item" th:href="@{/requests/{id}(id=${r.id})}" style="text-decoration: none; color: inherit; display: block;">
                    <div class="request-title" th:text="${r.title}">Request Titel</div>
                    <div class="request-meta" th:if="${r.status}" th:text="${r.status}">Status</div>
                  </a>
                </div>
              </div>
            </div>
          </div>

        </div><!-- /accordion -->

      </div><!-- /sidebar-content -->
    </div>
</body>
</html>
