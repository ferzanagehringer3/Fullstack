<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DalZana Connect</title>
  <style>
    body { margin: 0; font-family: Arial, sans-serif; }
    .app { height: 100vh; display: flex; }
    .left { width: 240px; border-right: 1px solid #ddd; padding: 12px; }
    .main { flex: 1; padding: 12px; display: flex; flex-direction: column; }
    .teams button { display: block; width: 100%; margin: 6px 0; padding: 8px; text-align: left; }
    .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #ddd; padding-bottom: 10px; }
    .header-actions { display: flex; align-items: center; gap: 8px; margin-left: auto; }
    .chat { flex: 1; padding: 12px 0; overflow: auto; }
    .msg { margin: 6px 0; }
    .composer { display: flex; gap: 8px; border-top: 1px solid #ddd; padding-top: 10px; }
    input[type="text"] { flex: 1; padding: 8px; }
  </style>
</head>

<body>
  <div class="app">
    <!-- LEFT: Teams -->
    <div class="left">
      <h3>Teams</h3>
      <div class="teams" id="teamList">
        <div th:if="${#lists.isEmpty(teams)}">Keine Teams vorhanden</div>
        <button th:each="t : ${teams}"
                class="team"
                th:data-team-id="${t.id}"
                th:data-team-name="${t.name}"
                th:text="${t.name}">
          Team
        </button>
      </div>
    </div>

    <!-- CENTER: Chat -->
    <div class="main">
      <div class="header">
        <h2 id="teamTitle" th:if="${!#lists.isEmpty(teams)}" th:text="${teams[0].name}">Team</h2>
        <h2 id="teamTitle" th:if="${#lists.isEmpty(teams)}">Kein Team</h2>

        <div class="header-actions">
          <a id="filesLink"
             th:if="${!#lists.isEmpty(teams)}"
             th:href="@{/teams/{teamId}/files(teamId=${teams[0].id})}"
             style="text-decoration: none;">
            <button id="filesBtn">Files</button>
          </a>
          <button id="filesBtn" th:if="${#lists.isEmpty(teams)}" disabled>Files</button>

          <a id="logoutLink" th:href="@{/logout}" style="text-decoration: none;">
            <button id="logoutBtn">Logout</button>
          </a>
        </div>
      </div>

      <div class="chat" id="chatBox">
        <div class="msg"><b>Alice:</b> Hello team!</div>
        <div class="msg"><b>Bob:</b> Hi!</div>
      </div>

      <form class="composer" id="chatForm">
        <input id="messageInput" type="text" placeholder="Type a message..." />
        <button type="submit">Send</button>
      </form>
    </div>
  </div>



  <script>
    // Switch team title + files link
    document.getElementById("teamList").addEventListener("click", (e) => {
      const btn = e.target.closest(".team");
      if (!btn) return;

      const teamName = btn.dataset.teamName;
      const teamId = btn.dataset.teamId;

      if (teamName) {
        document.getElementById("teamTitle").textContent = teamName;
      }

      const filesLink = document.getElementById("filesLink");
      if (filesLink && teamId) {
        filesLink.setAttribute("href", `/teams/${teamId}/files`);
      }
    });

    // Send message (mock)
    document.getElementById("chatForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const input = document.getElementById("messageInput");
      const text = input.value.trim();
      if (!text) return;

      const msg = document.createElement("div");
      msg.className = "msg";
      msg.innerHTML = "<b>You:</b> " + text;

      const box = document.getElementById("chatBox");
      box.appendChild(msg);
      box.scrollTop = box.scrollHeight;
      input.value = "";
    });

    // Files button links to selected team
  </script>
</body>
</html>
